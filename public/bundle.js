!function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var r={};e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=2)}([function(t,e,r){"use strict";function n(t){document.querySelector(t).classList.add("active")}function o(t){document.querySelector(t).classList.remove("active");for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];r.length>0&&r[0](r[1])}function a(t){console.error(t),alert("There was an authentication error, please log in again"),window.location.href="/",o("#loading"),o("#loggedin",n,"#login")}t.exports={addActiveClass:n,removeActiveClass:o,errorHandler:a}},function(t,e,r){"use strict";var n=function(){var t="https://api.spotify.com/v1",e=null,r=null,o=function(t,e){return t.abort=e,t},a=function(t,e){var n;if(null!==r){var a=r.defer();t(function(t){a.resolve(t)},function(t){a.reject(t)}),n=a.promise}else window.Promise&&(n=new window.Promise(t));return n?new o(n,e):null},s=function(){var t=Array.prototype.slice.call(arguments),e=t[0],r=t.slice(1);return e=e||{},r.forEach(function(t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}),e},i=function(t,e){var r="";for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];r+=encodeURIComponent(n)+"="+encodeURIComponent(o)+"&"}return r.length>0&&(r=r.substring(0,r.length-1),t=t+"?"+r),t},l=function(t,r){var n=new XMLHttpRequest,o=function(o,a){function s(t){o&&o(t),r&&r(null,t)}function l(){a&&a(n),r&&r(n,null)}var u=t.type||"GET";if(n.open(u,i(t.url,t.params)),e&&n.setRequestHeader("Authorization","Bearer "+e),t.contentType&&n.setRequestHeader("Content-Type",t.contentType),n.onreadystatechange=function(){if(4===n.readyState){var t=null;try{t=n.responseText?JSON.parse(n.responseText):""}catch(t){console.error(t)}n.status>=200&&n.status<300?s(t):l()}},"GET"===u)n.send(null);else{var c=null;t.postData&&(c="image/jpeg"===t.contentType?t.postData:JSON.stringify(t.postData)),n.send(c)}};return r?(o(),null):a(o,function(){n.abort()})},u=function(t,e,r,n){var o={},a=null;return"object"==typeof e?(o=e,a=r):"function"==typeof e&&(a=e),"GET"!==(t.type||"GET")&&t.postData&&!n?t.postData=s(t.postData,o):t.params=s(t.params,o),l(t,a)},c=function(){};return c.prototype={constructor:n},c.prototype.getGeneric=function(t,e){return u({url:t},e)},c.prototype.getMe=function(e,r){return u({url:t+"/me"},e,r)},c.prototype.getMySavedTracks=function(e,r){return u({url:t+"/me/tracks"},e,r)},c.prototype.addToMySavedTracks=function(e,r,n){return u({url:t+"/me/tracks",type:"PUT",postData:e},r,n)},c.prototype.removeFromMySavedTracks=function(e,r,n){return u({url:t+"/me/tracks",type:"DELETE",postData:e},r,n)},c.prototype.containsMySavedTracks=function(e,r,n){var o={url:t+"/me/tracks/contains",params:{ids:e.join(",")}};return u(o,r,n)},c.prototype.getMySavedAlbums=function(e,r){return u({url:t+"/me/albums"},e,r)},c.prototype.addToMySavedAlbums=function(e,r,n){return u({url:t+"/me/albums",type:"PUT",postData:e},r,n)},c.prototype.removeFromMySavedAlbums=function(e,r,n){return u({url:t+"/me/albums",type:"DELETE",postData:e},r,n)},c.prototype.containsMySavedAlbums=function(e,r,n){var o={url:t+"/me/albums/contains",params:{ids:e.join(",")}};return u(o,r,n)},c.prototype.getMyTopArtists=function(e,r){return u({url:t+"/me/top/artists"},e,r)},c.prototype.getMyTopTracks=function(e,r){return u({url:t+"/me/top/tracks"},e,r)},c.prototype.getMyRecentlyPlayedTracks=function(e,r){return u({url:t+"/me/player/recently-played"},e,r)},c.prototype.followUsers=function(e,r){var n={url:t+"/me/following/",type:"PUT",params:{ids:e.join(","),type:"user"}};return u(n,r)},c.prototype.followArtists=function(e,r){var n={url:t+"/me/following/",type:"PUT",params:{ids:e.join(","),type:"artist"}};return u(n,r)},c.prototype.followPlaylist=function(e,r,n,o){var a={url:t+"/users/"+encodeURIComponent(e)+"/playlists/"+r+"/followers",type:"PUT",postData:{}};return u(a,n,o)},c.prototype.unfollowUsers=function(e,r){var n={url:t+"/me/following/",type:"DELETE",params:{ids:e.join(","),type:"user"}};return u(n,r)},c.prototype.unfollowArtists=function(e,r){var n={url:t+"/me/following/",type:"DELETE",params:{ids:e.join(","),type:"artist"}};return u(n,r)},c.prototype.unfollowPlaylist=function(e,r,n){var o={url:t+"/users/"+encodeURIComponent(e)+"/playlists/"+r+"/followers",type:"DELETE"};return u(o,n)},c.prototype.isFollowingUsers=function(e,r){var n={url:t+"/me/following/contains",type:"GET",params:{ids:e.join(","),type:"user"}};return u(n,r)},c.prototype.isFollowingArtists=function(e,r){var n={url:t+"/me/following/contains",type:"GET",params:{ids:e.join(","),type:"artist"}};return u(n,r)},c.prototype.areFollowingPlaylist=function(e,r,n,o){var a={url:t+"/users/"+encodeURIComponent(e)+"/playlists/"+r+"/followers/contains",type:"GET",params:{ids:n.join(",")}};return u(a,o)},c.prototype.getFollowedArtists=function(e,r){return u({url:t+"/me/following",type:"GET",params:{type:"artist"}},e,r)},c.prototype.getUser=function(e,r,n){var o={url:t+"/users/"+encodeURIComponent(e)};return u(o,r,n)},c.prototype.getUserPlaylists=function(e,r,n){var o;return"string"==typeof e?o={url:t+"/users/"+encodeURIComponent(e)+"/playlists"}:(o={url:t+"/me/playlists"},n=r,r=e),u(o,r,n)},c.prototype.getPlaylist=function(e,r,n,o){var a={url:t+"/users/"+encodeURIComponent(e)+"/playlists/"+r};return u(a,n,o)},c.prototype.getPlaylistTracks=function(e,r,n,o){var a={url:t+"/users/"+encodeURIComponent(e)+"/playlists/"+r+"/tracks"};return u(a,n,o)},c.prototype.createPlaylist=function(e,r,n){var o={url:t+"/users/"+encodeURIComponent(e)+"/playlists",type:"POST",postData:r};return u(o,r,n)},c.prototype.changePlaylistDetails=function(e,r,n,o){var a={url:t+"/users/"+encodeURIComponent(e)+"/playlists/"+r,type:"PUT",postData:n};return u(a,n,o)},c.prototype.addTracksToPlaylist=function(e,r,n,o,a){var s={url:t+"/users/"+encodeURIComponent(e)+"/playlists/"+r+"/tracks",type:"POST",postData:{uris:n}};return u(s,o,a,!0)},c.prototype.replaceTracksInPlaylist=function(e,r,n,o){var a={url:t+"/users/"+encodeURIComponent(e)+"/playlists/"+r+"/tracks",type:"PUT",postData:{uris:n}};return u(a,{},o)},c.prototype.reorderTracksInPlaylist=function(e,r,n,o,a,s){var i={url:t+"/users/"+encodeURIComponent(e)+"/playlists/"+r+"/tracks",type:"PUT",postData:{range_start:n,insert_before:o}};return u(i,a,s)},c.prototype.removeTracksFromPlaylist=function(e,r,n,o){var a=n.map(function(t){return"string"==typeof t?{uri:t}:t}),s={url:t+"/users/"+encodeURIComponent(e)+"/playlists/"+r+"/tracks",type:"DELETE",postData:{tracks:a}};return u(s,{},o)},c.prototype.removeTracksFromPlaylistWithSnapshotId=function(e,r,n,o,a){var s=n.map(function(t){return"string"==typeof t?{uri:t}:t}),i={url:t+"/users/"+encodeURIComponent(e)+"/playlists/"+r+"/tracks",type:"DELETE",postData:{tracks:s,snapshot_id:o}};return u(i,{},a)},c.prototype.removeTracksFromPlaylistInPositions=function(e,r,n,o,a){var s={url:t+"/users/"+encodeURIComponent(e)+"/playlists/"+r+"/tracks",type:"DELETE",postData:{positions:n,snapshot_id:o}};return u(s,{},a)},c.prototype.uploadCustomPlaylistCoverImage=function(e,r,n,o){var a={url:t+"/users/"+encodeURIComponent(e)+"/playlists/"+r+"/images",type:"PUT",postData:n.replace(/^data:image\/jpeg;base64,/,""),contentType:"image/jpeg"};return u(a,{},o)},c.prototype.getAlbum=function(e,r,n){return u({url:t+"/albums/"+e},r,n)},c.prototype.getAlbumTracks=function(e,r,n){return u({url:t+"/albums/"+e+"/tracks"},r,n)},c.prototype.getAlbums=function(e,r,n){var o={url:t+"/albums/",params:{ids:e.join(",")}};return u(o,r,n)},c.prototype.getTrack=function(e,r,n){var o={};return o.url=t+"/tracks/"+e,u(o,r,n)},c.prototype.getTracks=function(e,r,n){var o={url:t+"/tracks/",params:{ids:e.join(",")}};return u(o,r,n)},c.prototype.getArtist=function(e,r,n){return u({url:t+"/artists/"+e},r,n)},c.prototype.getArtists=function(e,r,n){var o={url:t+"/artists/",params:{ids:e.join(",")}};return u(o,r,n)},c.prototype.getArtistAlbums=function(e,r,n){return u({url:t+"/artists/"+e+"/albums"},r,n)},c.prototype.getArtistTopTracks=function(e,r,n,o){return u({url:t+"/artists/"+e+"/top-tracks",params:{country:r}},n,o)},c.prototype.getArtistRelatedArtists=function(e,r,n){return u({url:t+"/artists/"+e+"/related-artists"},r,n)},c.prototype.getFeaturedPlaylists=function(e,r){return u({url:t+"/browse/featured-playlists"},e,r)},c.prototype.getNewReleases=function(e,r){return u({url:t+"/browse/new-releases"},e,r)},c.prototype.getCategories=function(e,r){return u({url:t+"/browse/categories"},e,r)},c.prototype.getCategory=function(e,r,n){return u({url:t+"/browse/categories/"+e},r,n)},c.prototype.getCategoryPlaylists=function(e,r,n){return u({url:t+"/browse/categories/"+e+"/playlists"},r,n)},c.prototype.search=function(e,r,n,o){var a={url:t+"/search/",params:{q:e,type:r.join(",")}};return u(a,n,o)},c.prototype.searchAlbums=function(t,e,r){return this.search(t,["album"],e,r)},c.prototype.searchArtists=function(t,e,r){return this.search(t,["artist"],e,r)},c.prototype.searchTracks=function(t,e,r){return this.search(t,["track"],e,r)},c.prototype.searchPlaylists=function(t,e,r){return this.search(t,["playlist"],e,r)},c.prototype.getAudioFeaturesForTrack=function(e,r){var n={};return n.url=t+"/audio-features/"+e,u(n,{},r)},c.prototype.getAudioFeaturesForTracks=function(e,r){return u({url:t+"/audio-features",params:{ids:e}},{},r)},c.prototype.getAudioAnalysisForTrack=function(e,r){var n={};return n.url=t+"/audio-analysis/"+e,u(n,{},r)},c.prototype.getRecommendations=function(e,r){return u({url:t+"/recommendations"},e,r)},c.prototype.getAvailableGenreSeeds=function(e){return u({url:t+"/recommendations/available-genre-seeds"},{},e)},c.prototype.getMyDevices=function(e){return u({url:t+"/me/player/devices"},{},e)},c.prototype.getMyCurrentPlaybackState=function(e,r){return u({url:t+"/me/player"},e,r)},c.prototype.getMyCurrentPlayingTrack=function(e,r){return u({url:t+"/me/player/currently-playing"},e,r)},c.prototype.transferMyPlayback=function(e,r,n){var o=r||{};return o.device_ids=e,u({type:"PUT",url:t+"/me/player",postData:o},r,n)},c.prototype.play=function(e,r){var n="device_id"in e?{device_id:e.device_id}:null,o={};return["context_uri","uris","offset"].forEach(function(t){t in e&&(o[t]=e[t])}),u({type:"PUT",url:t+"/me/player/play",params:n,postData:o},"function"==typeof e?e:{},r)},c.prototype.pause=function(e,r){var n="device_id"in e?{device_id:e.device_id}:null;return u({type:"PUT",url:t+"/me/player/pause",params:n},e,r)},c.prototype.skipToNext=function(e,r){var n="device_id"in e?{device_id:e.device_id}:null;return u({type:"POST",url:t+"/me/player/next",params:n},e,r)},c.prototype.skipToPrevious=function(e,r){var n="device_id"in e?{device_id:e.device_id}:null;return u({type:"POST",url:t+"/me/player/previous",params:n},e,r)},c.prototype.seek=function(e,r,n){var o={position_ms:e};return"device_id"in r&&(o.device_id=r.device_id),u({type:"PUT",url:t+"/me/player/seek",params:o},r,n)},c.prototype.setRepeat=function(e,r,n){var o={state:e};return"device_id"in r&&(o.device_id=r.device_id),u({type:"PUT",url:t+"/me/player/repeat",params:o},r,n)},c.prototype.setVolume=function(e,r,n){var o={volume_percent:e};return"device_id"in r&&(o.device_id=r.device_id),u({type:"PUT",url:t+"/me/player/volume",params:o},r,n)},c.prototype.setShuffle=function(e,r,n){var o={state:e};return"device_id"in r&&(o.device_id=r.device_id),u({type:"PUT",url:t+"/me/player/shuffle",params:o},r,n)},c.prototype.getAccessToken=function(){return e},c.prototype.setAccessToken=function(t){e=t},c.prototype.setPromiseImplementation=function(t){var e=!1;try{var n=new t(function(t){t()});"function"==typeof n.then&&"function"==typeof n.catch&&(e=!0)}catch(t){console.error(t)}if(!e)throw new Error("Unsupported implementation of Promises/A+");r=t},c}();"object"==typeof t&&"object"==typeof t.exports&&(t.exports=n)},function(t,e,r){"use strict";var n=r(3).accessPlaylist,o=r(0).removeActiveClass,a=r(0).addActiveClass,s=(r(0).errorHandler,function(){var t={},e=[],r=/#([^&;=]+)=?([^&;]*)/g,n=window.location.hash;return""!==n&&(e=r.exec(n),t[e[1]]=decodeURIComponent(e[2])),t});!function(){var t=s(),e=t.access_token;t.error?(console.log("There was an error during the authentication"),alert("There was an error during the authentication"),window.location.href="/"):e?(o("#login",a,"#loading"),n(e)):o("#loggedin",a,"#login")}()},function(t,e,r){"use strict";function n(){k(""===this.value?u:T(this.value.toLowerCase()))}var o=r(1),a=r(4).getOrRemoveTracks,s=r(0).removeActiveClass,i=r(0).addActiveClass,l=r(0).errorHandler,u=[],c=0,p=new o,y=function(t){return new Promise(function(e,r){e(p.setAccessToken(t))}).then(function(t){return f()}).then(function(t){return d(t)}).then(function(t){return m(t)}).then(function(t){return k(u)}).catch(function(t){l(t)})},f=function(){return Promise.resolve(p.getMe()).then(function(t){return s("#loading",i,"#loggedin"),document.querySelector(".display-name").textContent=t.id,document.querySelector(".playlists").innerHTML='<p class="loading"><i class="fa fa-refresh fa-spin fa-3x fa-fw"></i></p>',t.id}).catch(function(t){return Promise.reject(t)})},d=function(t){return Promise.resolve(p.getUserPlaylists({limit:1})).then(function(e){return c=e.total,console.log("Number of playlists: "+e.total),document.querySelector(".number-of-playlists").textContent=e.total,t}).catch(function(t){return Promise.reject(t)})},m=function(t){var e=[];console.log("== start retrieving playlists ==");for(var r=0;r<c;r+=20)e.push(p.getUserPlaylists(t,{offset:r}).then(function(t){t.items.forEach(function(t){u.push({owner:t.owner.id,name:t.name,id:t.id,totalTracks:t.tracks.total})})}).catch(function(t){return Promise.reject(t)}));return Promise.all(e).then(console.log("== finished retrieving playlists ==")).catch(function(t){return Promise.reject(t)})},v=function(t){document.querySelector(".playlists").innerHTML='<li class="playlist-header">\n      Playlists\n    </li>'},g=function(t){var e=t.map(function(t){return'\n      <li id="'+t.id+'" class="playlist">\n        <div class="playlist-info">\n          <div class="playlist-name">'+t.name+'<span class="playlist-num-tracks"> ['+t.totalTracks+' tracks]</span></div> \n          <div class="playlist-owner">Owned by '+t.owner+'</div>  \n        </div>\n        <div id="track-info-'+t.id+'" class="tracks"></div>\n      </li>\n    '}).join("");document.querySelector(".playlists").innerHTML+=""+e,i(".playlists")},h=function(){document.querySelectorAll(".playlist-info").forEach(function(t){var e=t.childNodes[3].textContent.match(/Owned by (.*)/)[1],r=t.childNodes[1].childNodes[1].textContent.match(/([0-9]+) /)[1];t.addEventListener("click",a.bind(void 0,t.parentNode.id,e,r))})},k=function(t){s(".playlists"),console.log("== start displaying playlists =="),setTimeout(function(){v(),g(t),h(),console.log("== finish displaying playlists ==")},500)},T=function(t){return u.filter(function(e){return e.name.toLowerCase().includes(t)||e.owner.toLowerCase().includes(t)})};document.querySelector("input").addEventListener("keyup",n),t.exports={accessPlaylist:y}},function(t,e,r){"use strict";function n(t){console.log("== downloading tracks ==");var e=m(t,".playlist-owner"),r=m(t,".playlist-name"),n=e+", Playlist Name: "+r+"\n";n+="Name,Album,Artists\n",document.querySelectorAll(".tracks-"+t).forEach(function(t){n+=Array.from(t.children)[0].textContent+","+Array.from(t.children)[1].textContent+","+Array.from(t.children)[2].textContent,n+="\n"});var o=document.createElement("a");o.href="data:text/csv;charset=utf-8,"+encodeURI(n),o.target="_blank",o.download="playlist.csv",o.click()}var o=r(1),a=r(0).removeActiveClass,s=r(0).addActiveClass,i=r(0).errorHandler,l=new o,u=[],c=function(t,e,r){document.getElementsByClassName("tracks-"+t).length>0?(document.getElementById("track-info-"+t).innerHTML="",a("#track-info-"+t)):(s("#track-info-"+t),document.getElementById("track-info-"+t).innerHTML='<p class="loading"><i class="fa fa-refresh fa-spin fa-3x fa-fw"></i></p>',p(t,e,r))},p=function(t,e,r){return u=[],y(t,e,r).then(function(e){return d(t,u)}).catch(function(t){i(t)})},y=function(t,e,r){var n=[];console.log("== start retrieving tracks ==");for(var o=0;o<r;o+=100)n.push(l.getPlaylistTracks(e,t,{offset:o}).then(function(t){t.items.forEach(function(t){var e=t.track.id,r=t.track.name,n=t.track.album.name,o=t.track.artists.map(function(t){return t.name});u.push({id:e,name:r,album:n,artists:o})})}).catch(function(t){return Promise.reject(t)}));return Promise.all(n).then(console.log("== finished retrieving tracks ==")).catch(function(t){return Promise.reject(t)})},f=function(t,e){return e.map(function(e){return'<tr class="tracks-'+t+'">\n      <td class="track-name">'+e.name+'</td> \n      <td class="track-album">'+e.album+'</td> \n      <td class="track-artists">'+e.artists.join("; ")+"</td>\n    </tr>"}).join("")},d=function(t,e){console.log("== displaying "+e.length+" tracks ==");document.getElementById("track-info-"+t);document.getElementById("track-info-"+t).innerHTML='<table class="track-table"> \n      <tr class="track-heading">\n        <th class="track-name">Name</th>\n        <th class="track-album">Album</th>\n        <th class="track-artists">Artists <span id="dl-'+t+'" class="download"><i class="fa fa-download" aria-hidden="true"></i></span></th>\n      </tr>\n      '+f(t,e)+" \n    </table>";var r=document.getElementById("dl-"+t);s("#track-info-"+t),r.addEventListener("click",n.bind(void 0,t))},m=function(t,e){return document.getElementById(t).querySelector(".playlist-info").querySelector(e).textContent};t.exports={getOrRemoveTracks:c}}]);